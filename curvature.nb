(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50722,       1672]
NotebookOptionsPosition[     46134,       1523]
NotebookOutlinePosition[     46915,       1548]
CellTagsIndexPosition[     46872,       1545]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Curvature and the Einstein Equation", "Subtitle"],

Cell[TextData[{
 "This is the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook ",
 StyleBox["Curvature and the Einstein Equation ",
  FontSlant->"Italic"],
 StyleBox["available from the book website.  F",
  FontVariations->{"CompatibilityType"->0}],
 "rom a given metric ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontSlant->"Italic"], "\[Alpha]\[Beta]"], TraditionalForm]]],
 " , it computes the components of the following: the inverse metric, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Lambda]\[Sigma]"], TraditionalForm]]],
 ", the Christoffel symbols or affine connection,"
}], "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Nu]"], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SuperscriptBox["g", "\[Lambda]\[Sigma]"], "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Nu]"]}], "+", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Mu]"]}], "-", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Sigma]"], " ", 
        SubscriptBox["g", "\[Mu]\[Nu]"]}]}], ")"}]}]}], TraditionalForm]]],
 ","
}], "Text"],

Cell[TextData[{
 " ( ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"\[Alpha]", "  "}]], TraditionalForm]]],
 "stands for the partial derivative ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[PartialD]", 
    RowBox[{"/", 
     RowBox[{"\[PartialD]", 
      SuperscriptBox["x", "\[Alpha]"]}]}]}], TraditionalForm]]],
 "), the Riemann tensor,"
}], "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], " ", 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Sigma]"]}], 
     "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Sigma]"], " ", 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Nu]"]}], "+", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Eta]"], "\[Mu]\[Sigma]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Eta]\[Nu]"]}], "-", 
     
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Eta]"], "\[Mu]\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], 
       "\[Eta]\[Sigma]"]}]}]}], TraditionalForm]]],
 ","
}], "Text"],

Cell["the Ricci tensor", "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "\[Mu]\[Nu]"], "=", 
    SubscriptBox[
     SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Lambda]\[Nu]"]}], 
   TraditionalForm]]],
 ","
}], "Text"],

Cell["the scalar curvature,", "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "=", 
    RowBox[{
     SuperscriptBox["g", "\[Mu]\[Nu]"], 
     SubscriptBox["R", "\[Mu]\[Nu]"]}]}], TraditionalForm]]],
 ","
}], "Text"],

Cell["and the Einstein tensor,", "Text"],

Cell[TextData[{
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Mu]\[Nu]"], "=", 
    RowBox[{
     SubscriptBox["R", "\[Mu]\[Nu]"], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SubscriptBox["g", "\[Mu]\[Nu]"], "R"}]}]}], TraditionalForm]]],
 "."
}], "Text"],

Cell[TextData[{
 "You must input the covariant components of the metric tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]]],
 " by editing the relevant input line in this ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook. You may also wish to change the names of the coordinates. Only \
the nonzero components of the above quantities are displayed as the output. \
All the components computed are in the ",
 StyleBox["coordinate basis ",
  FontSlant->"Italic"],
 StyleBox["in which the metric was specified. ",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"],

Cell[CellGroupData[{

Cell["Clearing the values of symbols:", "Subsubsection"],

Cell["\<\
First clear any values that may already have been assigned to the names of \
the various objects to be calculated. The names of the coordinates that you \
will use are also cleared.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "coord", ",", " ", "metric", ",", "inversemetric", ",", " ", "affine", ",", 
   " ", "riemann", ",", " ", "ricci", ",", " ", "scalar", ",", " ", 
   "einstein", ",", "r", ",", "\[Theta]", ",", "\[Phi]", ",", "t"}], 
  "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting the dimension:", "Subsubsection"],

Cell[TextData[{
 "The dimension ",
 StyleBox["n ",
  FontWeight->"Bold"],
 StyleBox["of the spacetime (or space) must be set:",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "4"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.7296788980234337`*^9, 3.72967899120877*^9, 
  3.7296790644445844`*^9, 3.729679126813858*^9, 3.7296791848944654`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining a list of coordinates:", "Subsubsection"],

Cell["\<\
The example given here is the Schwarzschild metric. The coordinate choice of \
Schwarzschild is appropriate for this spherically symmetric spacetime. \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"coord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.729678774691152*^9, 3.729678776840952*^9}, {
  3.7296790488558903`*^9, 3.7296790509252963`*^9}, {3.72967911506855*^9, 
  3.729679116974615*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]], "Output",
 CellChangeTimes->{3.7296788980371885`*^9, 3.729678991222783*^9, 
  3.729679064455615*^9, 3.7296791268268924`*^9, 3.72967918490798*^9}]
}, Open  ]],

Cell[TextData[{
 "You can change the names of the coordinates by simply editing the \
definition of ",
 StyleBox["coord",
  FontWeight->"Bold"],
 ", for example, to ",
 StyleBox["coord = {x, y, z, t}",
  FontWeight->"Bold"],
 ", when another set of coordinate names is more appropriate. In this program \
indices range over ",
 StyleBox["1 ",
  FontWeight->"Bold"],
 StyleBox["to ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["n.  ",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["Thus for spacetime they range from 1 to 4 and ",
  FontVariations->{"CompatibilityType"->0}],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "4"], TraditionalForm]]],
 " is the same as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "0"], TraditionalForm]]],
 " used in the text. "
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining the metric:", "Subsubsection"],

Cell["\<\
Input the metric as a list of lists, i.e., as a matrix. You can input the \
components of any metric here, but you must specify them as explicit \
functions of the coordinates.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["c", "2"]}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"], 
       RowBox[{"1", "-", 
        RowBox[{"\[Kappa]", " ", 
         SuperscriptBox["r", "2"]}]}]], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"], 
       SuperscriptBox["r", "2"]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"], 
       SuperscriptBox["r", "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.729678811409869*^9, 3.729678879971895*^9}, {
  3.729678986552992*^9, 3.729678986970954*^9}, {3.729679058203906*^9, 
  3.729679062767951*^9}, {3.729679120875603*^9, 3.729679125291936*^9}, {
  3.7296791816982546`*^9, 3.729679183453264*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["c", "2"]}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"S", "[", "t", "]"}], "2"], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}]], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"S", "[", "t", "]"}], "2"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"S", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7296788980522227`*^9, 3.7296789912383256`*^9, 
  3.7296791268414307`*^9, 3.7296791849245234`*^9}]
}, Open  ]],

Cell["You can also display this in matrix form.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       SuperscriptBox["c", "2"]}], "0", "0", "0"},
     {"0", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"], 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}]], "0", "0"},
     {"0", "0", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"]}], "0"},
     {"0", "0", "0", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.72967889807075*^9, 3.7296789912539186`*^9, 
  3.729679126855011*^9, 3.729679184937469*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Note:", "Subsubsection"],

Cell[TextData[{
 "It is important not to use the symbols, ",
 StyleBox["i",
  FontWeight->"Bold"],
 ", ",
 StyleBox["j",
  FontWeight->"Bold"],
 ", ",
 StyleBox["k",
  FontWeight->"Bold"],
 ", ",
 StyleBox["l,",
  FontWeight->"Bold"],
 StyleBox[" ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["s, ",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["or ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["n",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox[" ",
  FontWeight->"Bold"],
 "as constants or coordinates in the metric that you specify above. The \
reason is that the first five of  those symbols are used as summation or \
table indices in the calculations done below, and ",
 StyleBox["n ",
  FontWeight->"Bold"],
 StyleBox["is the dimension of the space. ",
  FontVariations->{"CompatibilityType"->0}],
 "For example, if ",
 StyleBox["m",
  FontWeight->"Bold"],
 " were used as a summation or table index below, then you would get the \
wrong answer for the present metric because the ",
 StyleBox["m",
  FontWeight->"Bold"],
 " in the metric would be treated as an index, rather than as the mass."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the inverse metric:", "Subsubsection"],

Cell["The inverse metric is obtained through matrix inversion.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inversemetric", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["c", "2"]]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], 
      SuperscriptBox[
       RowBox[{"S", "[", "t", "]"}], "2"]], ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.729678898112356*^9, 3.7296789912677035`*^9, 
  3.7296791268680434`*^9, 3.729679184963538*^9}]
}, Open  ]],

Cell["This can also be displayed in matrix form:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inversemetric", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox["c", "2"]]}], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], 
       SuperscriptBox[
        RowBox[{"S", "[", "t", "]"}], "2"]], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"S", "[", "t", "]"}], "2"]}]], "0"},
     {"0", "0", "0", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"S", "[", "t", "]"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7296788981289005`*^9, 3.729678991283245*^9, 
  3.729679126884596*^9, 3.7296791849775753`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the Christoffel symbols:", "Subsubsection"],

Cell[TextData[{
 "The calculation of the components of the Christoffel symbols is done by \
transcribing the definition given earlier into the notation of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and using the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " functions ",
 StyleBox["D",
  FontWeight->"Bold"],
 " for taking partial derivatives, ",
 StyleBox["Sum",
  FontWeight->"Bold"],
 " for summing over repeated indices, ",
 StyleBox["Table",
  FontWeight->"Bold"],
 " for forming a list of components, and ",
 StyleBox["Simplify",
  FontWeight->"Bold"],
 " for simplifying the result."
}], "Text"],

Cell[BoxData[
 RowBox[{"affine", ":=", 
  RowBox[{"affine", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "+", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], " ", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying the Christoffel symbols:", "Subsubsection"],

Cell[TextData[{
 "The nonzero Christoffel symbols are displayed below. You need not follow \
the details of constructing the functions that we use for that purpose.  In \
the output the symbol \[CapitalGamma][1,2,3] stands for",
 StyleBox[" ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "1"], "23"], TraditionalForm]]],
 ". Because the Christoffel symbols are symmetric under interchange of the \
last two indices, only the independent components are displayed."
}], "Text"],

Cell[BoxData[
 RowBox[{"listaffine", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", "0"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}], 
    " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listaffine", "]"}], ",", "Null"}], "]"}], ",",
      "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\[CapitalGamma][1, 2, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"S", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"\[CapitalGamma][1, 3, 3]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"S", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      SuperscriptBox["c", "2"]]},
    {"\<\"\[CapitalGamma][1, 4, 4]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"S", "[", "t", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      SuperscriptBox["c", "2"]]},
    {"\<\"\[CapitalGamma][2, 2, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["S", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"S", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][2, 2, 2]\"\>", 
     FractionBox[
      RowBox[{"r", " ", "\[Kappa]"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}]]},
    {"\<\"\[CapitalGamma][2, 3, 3]\"\>", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]},
    {"\<\"\[CapitalGamma][2, 4, 4]\"\>", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]},
    {"\<\"\[CapitalGamma][3, 3, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["S", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"S", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][3, 3, 2]\"\>", 
     FractionBox["1", "r"]},
    {"\<\"\[CapitalGamma][3, 4, 4]\"\>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
    {"\<\"\[CapitalGamma][4, 4, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["S", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"S", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][4, 4, 2]\"\>", 
     FractionBox["1", "r"]},
    {"\<\"\[CapitalGamma][4, 4, 3]\"\>", 
     RowBox[{"Cot", "[", "\[Theta]", "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{3.7296788981949105`*^9, 3.7296789913268614`*^9, 
  3.729679126925545*^9, 3.729679185024049*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating and displaying the Riemann tensor:", "Subsubsection"],

Cell[TextData[{
 "The components of the Riemann tensor, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], 
   TraditionalForm]]],
 ", are calculated using the definition given above."
}], "Text"],

Cell[BoxData[
 RowBox[{"riemann", ":=", 
  RowBox[{"riemann", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
         RowBox[{"coord", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
         RowBox[{"coord", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], " ", "]"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k", ",", "s"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "l", ",", "s"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"],

Cell[TextData[{
 "The nonzero components are displayed by the following functions. In the \
output, the symbol R[1, 2, 1, 3] stands for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "1"], "213"], TraditionalForm]]],
 ", and similarly for the other components.",
 " You can obtain R[1, 2, 3, 1] from R[1, 2, 1, 3] using the antisymmetry of \
the Riemann tensor under exchange of the last two indices. The antisymmetry \
under exchange of the first two indices of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "\[Lambda]\[Mu]\[Nu]\[Sigma]"], TraditionalForm]]],
 " is not evident in the output because the components of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], 
   TraditionalForm]]],
 " are displayed."
}], "Text"],

Cell[BoxData[
 RowBox[{"listriemann", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"R", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
       "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", 
      RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listriemann", "]"}], ",", "Null"}], "]"}], 
     ",", "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R[1, 2, 2, 1]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"S", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"R[1, 3, 3, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"S", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["S", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"R[1, 4, 4, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"S", "[", "t", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["S", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"R[2, 1, 2, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["S", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"S", "[", "t", "]"}]]}]},
    {"\<\"R[2, 3, 3, 2]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"R[2, 4, 4, 2]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"R[3, 1, 3, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["S", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"S", "[", "t", "]"}]]}]},
    {"\<\"R[3, 2, 3, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["S", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"R[3, 4, 4, 3]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"R[4, 1, 4, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["S", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"S", "[", "t", "]"}]]}]},
    {"\<\"R[4, 2, 4, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["S", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"R[4, 3, 4, 3]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["S", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
      SuperscriptBox["c", "2"]]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{3.7296788983456435`*^9, 3.7296789914201407`*^9, 
  3.729679126991727*^9, 3.72967918511079*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating and displaying the Ricci tensor:", "Subsubsection"],

Cell[TextData[{
 "The Ricci tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "\[Mu]\[Nu]"], TraditionalForm]]],
 " was defined by summing the first and third indices of the Riemann tensor \
(which has the first index already raised)."
}], "Text"],

Cell[BoxData[
 RowBox[{"ricci", ":=", 
  RowBox[{"ricci", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"],

Cell[TextData[{
 "Next we display the nonzero components. In the output, R[1, 2] denotes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "12"], TraditionalForm]]],
 ", and similarly for the other components."
}], "Text"],

Cell[BoxData[
 RowBox[{"listricci", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"ricci", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"R", "[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"ricci", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listricci", "]"}], ",", "Null"}], "]"}], ",", 
     "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R[1, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{
         SuperscriptBox["S", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"S", "[", "t", "]"}]]}]},
    {"\<\"R[2, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["S", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"S", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["S", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"R[3, 3]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"S", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      SuperscriptBox["c", "2"]]},
    {"\<\"R[4, 4]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"S", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["S", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      SuperscriptBox["c", "2"]]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{3.729678898480503*^9, 3.7296789914988055`*^9, 
  3.729679127030826*^9, 3.729679185158908*^9}]
}, Open  ]],

Cell["\<\
A vanishing table (as with the Schwarzschild metric example)  means that the \
vacuum Einstein equation is satisfied.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the scalar curvature:", "Subsubsection"],

Cell[TextData[{
 "The scalar curvature ",
 StyleBox["R",
  FontSlant->"Italic"],
 " is calculated using the inverse metric and the Ricci tensor. The result is \
displayed in the output line."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalar", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"inversemetric", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], 
      RowBox[{"ricci", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
   "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["S", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
     RowBox[{
      RowBox[{"S", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["S", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox[
    RowBox[{"S", "[", "t", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7296788985421667`*^9, 3.729678991526853*^9, 
  3.7296791270474005`*^9, 3.7296791851739473`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the Einstein tensor:", "Subsubsection"],

Cell[TextData[{
 "The Einstein tensor,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Mu]\[Nu]"], "=", 
    RowBox[{
     SubscriptBox["R", "\[Mu]\[Nu]"], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SubscriptBox["g", "\[Mu]\[Nu]"], "R"}]}]}], TraditionalForm]]],
 ", is found from the tensors already calculated."
}], "Text"],

Cell[BoxData[
 RowBox[{"einstein", ":=", 
  RowBox[{"einstein", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ricci", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "scalar", "*", "metric"}]}], 
    "]"}]}]}]], "Input"],

Cell["\<\
The results are displayed in the same way as for the Ricci tensor earlier.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"listeinstein", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"einstein", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"G", "[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"einstein", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listeinstein", "]"}], ",", "Null"}], "]"}], 
     ",", "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"G[1, 1]\"\>", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["S", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"S", "[", "t", "]"}], "2"]]},
    {"\<\"G[2, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["S", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"S", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["S", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Kappa]"}]}], ")"}]}]]},
    {"\<\"G[3, 3]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"S", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["S", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
       SuperscriptBox["c", "2"]]}]},
    {"\<\"G[4, 4]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "\[Kappa]"}], "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["S", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"S", "[", "t", "]"}], " ", 
           RowBox[{
            SuperscriptBox["S", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
       SuperscriptBox["c", "2"]]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{3.7296788986805344`*^9, 3.729678991590274*^9, 
  3.729679127091487*^9, 3.7296791852366147`*^9}]
}, Open  ]],

Cell["\<\
A vanishing table means that the vacuum Einstein equation is satisfied!\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acknowledgment", "Subsubsection"],

Cell[TextData[{
 "This program was kindly written by ",
 StyleBox["Leonard Parker, University of Wisconsin, Milwaukee ",
  FontSlant->"Italic"],
 StyleBox["especially ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox[" ",
  FontSlant->"Italic"],
 StyleBox["for this text. ",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{766, 772},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PostScriptOutputFile":>FrontEnd`FileName[{$RootDirectory, "home", "hartle", 
   "131book", "math", "Curvature"}, "curvature-n.ps1", CharacterEncoding -> 
  "ISO8859-1"]},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification->1.5,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 55, 0, 84, "Subtitle"],
Cell[638, 24, 643, 20, 136, "Text"],
Cell[1284, 46, 674, 21, 59, "Text"],
Cell[1961, 69, 376, 14, 45, "Text"],
Cell[2340, 85, 945, 29, 50, "Text"],
Cell[3288, 116, 32, 0, 45, "Text"],
Cell[3323, 118, 220, 9, 50, "Text"],
Cell[3546, 129, 37, 0, 45, "Text"],
Cell[3586, 131, 196, 8, 48, "Text"],
Cell[3785, 141, 40, 0, 45, "Text"],
Cell[3828, 143, 290, 12, 59, "Text"],
Cell[4121, 157, 619, 15, 191, "Text"],
Cell[CellGroupData[{
Cell[4765, 176, 56, 0, 58, "Subsubsection"],
Cell[4824, 178, 205, 4, 102, "Text"],
Cell[5032, 184, 285, 6, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5354, 195, 47, 0, 58, "Subsubsection"],
Cell[5404, 197, 183, 6, 45, "Text"],
Cell[CellGroupData[{
Cell[5612, 207, 49, 1, 45, "Input"],
Cell[5664, 210, 166, 2, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5879, 218, 56, 0, 58, "Subsubsection"],
Cell[5938, 220, 174, 3, 74, "Text"],
Cell[CellGroupData[{
Cell[6137, 227, 346, 8, 45, "Input"],
Cell[6486, 237, 241, 4, 45, "Output"]
}, Open  ]],
Cell[6742, 244, 823, 27, 106, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7602, 276, 45, 0, 58, "Subsubsection"],
Cell[7650, 278, 200, 4, 74, "Text"],
Cell[CellGroupData[{
Cell[7875, 286, 1209, 34, 77, "Input"],
Cell[9087, 322, 1036, 33, 70, "Output"]
}, Open  ]],
Cell[10138, 358, 57, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[10220, 362, 64, 1, 45, "Input"],
Cell[10287, 365, 1325, 39, 167, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11661, 410, 30, 0, 58, "Subsubsection"],
Cell[11694, 412, 1199, 40, 131, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12930, 457, 56, 0, 58, "Subsubsection"],
Cell[12989, 459, 72, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[13086, 463, 136, 3, 45, "Input"],
Cell[13225, 468, 1100, 35, 73, "Output"]
}, Open  ]],
Cell[14340, 506, 58, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[14423, 510, 71, 1, 45, "Input"],
Cell[14497, 513, 1403, 42, 205, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15949, 561, 61, 0, 58, "Subsubsection"],
Cell[16013, 563, 623, 21, 102, "Text"],
Cell[16639, 586, 1798, 50, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18474, 641, 60, 0, 58, "Subsubsection"],
Cell[18537, 643, 536, 12, 104, "Text"],
Cell[19076, 657, 864, 26, 75, "Input"],
Cell[CellGroupData[{
Cell[19965, 687, 364, 11, 45, "Input"],
Cell[20332, 700, 3462, 100, 625, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23843, 806, 71, 0, 58, "Subsubsection"],
Cell[23917, 808, 252, 8, 50, "Text"],
Cell[24172, 818, 1838, 51, 162, "Input"],
Cell[26013, 871, 807, 21, 109, "Text"],
Cell[26823, 894, 986, 29, 75, "Input"],
Cell[CellGroupData[{
Cell[27834, 927, 365, 11, 45, "Input"],
Cell[28202, 940, 5347, 162, 682, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33598, 1108, 69, 0, 58, "Subsubsection"],
Cell[33670, 1110, 254, 7, 105, "Text"],
Cell[33927, 1119, 579, 17, 133, "Input"],
Cell[34509, 1138, 222, 6, 74, "Text"],
Cell[34734, 1146, 734, 22, 133, "Input"],
Cell[CellGroupData[{
Cell[35493, 1172, 363, 11, 104, "Input"],
Cell[35859, 1185, 2948, 85, 249, "Output"]
}, Open  ]],
Cell[38822, 1273, 141, 3, 74, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39000, 1281, 58, 0, 58, "Subsubsection"],
Cell[39061, 1283, 203, 6, 74, "Text"],
Cell[CellGroupData[{
Cell[39289, 1293, 505, 16, 104, "Input"],
Cell[39797, 1311, 706, 21, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40552, 1338, 57, 0, 58, "Subsubsection"],
Cell[40612, 1340, 357, 12, 88, "Text"],
Cell[40972, 1354, 253, 8, 75, "Input"],
Cell[41228, 1364, 98, 2, 74, "Text"],
Cell[41329, 1368, 743, 22, 133, "Input"],
Cell[CellGroupData[{
Cell[42097, 1394, 366, 11, 104, "Input"],
Cell[42466, 1407, 3113, 90, 257, "Output"]
}, Open  ]],
Cell[45594, 1500, 95, 2, 74, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45726, 1507, 39, 0, 58, "Subsubsection"],
Cell[45768, 1509, 338, 10, 74, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

